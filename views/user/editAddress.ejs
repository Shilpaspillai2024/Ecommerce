<style>
    body{
        background-color: black;
    }
    .container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    border: .2em solid yellowgreen;
    border-radius:1rem ;
    color: #f0f0f0;
    margin-top: 2rem;
}

.form-group {
    margin-bottom: 20px;
}


 

.save-changes-btn {
    display: inline-block;
    padding: 10px 20px;
    background-color: #208826;
    color: #fff;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    
}
.cancel-btn{
    display: inline-block;
    padding: 10px 20px;
    border: none;
    border-radius: 10px;


}



.save-changes-btn:hover {
    background-color: #2ab300;
}


.mt-5 {
    margin-top: 30px;
}

</style>

<%-include('navbar') %>

<div class="container">
    <h2 class="mt-5 text-center">Edit Address</h2>

    <!-- Form for editing the address -->
    <form id="edit-address-form" action="/edit-address/<%= address._id %>" method="POST">
        <div class="form-group">
            <label for="edit-address-type">Address Type:</label>
            <select class="form-select" id="edit-address-type" name="addressType">
                <option value="home">Home</option>
                <option value="office">Office</option>
                <option value="other">Other</option>
            </select>
        </div>
        <div class="form-group">
            <label for="edit-address-contactName">Contact Name:</label>
            <input type="text" class="form-control" id="edit-address-contactName" name="contactName" value="<%= address.contactName %>">
        </div>

        <div class="form-group">
            <label for="new-address-doorNo">Door No:</label>
            <input type="text" class="form-control" id="new-address-doorNo" name="doorNo"value="<%= address.doorNo %>">
        </div>
        <div class="form-group">
            <label for="new-address-homeAddress">Address:</label>
            <input type="text" class="form-control" id="new-address-homeAddress" maxlength="100"name="homeAddress"value="<%= address.Address %>">
        </div>
        <div class="form-group">
            <label for="new-address-areaAddress">Area Address:</label>
            <input type="text" class="form-control" id="new-address-areaAddress" maxlength="100" name="areaAddress"value="<%= address.areaAddress %>">
        </div>
        <div class="form-group">
            <label for="new-address-landmark">Landmark:</label>
            <input type="text" class="form-control" id="new-address-landmark" maxlength="100" name="landmark"value="<%= address.landmark %>">
        </div>

        <div class="form-group">
            <label for="new-address-landmark">Phone:</label>
            <input type="text" class="form-control" id="new-address-phone" name="phone"value="<%= address.phone %>">
        </div>
        <div class="form-group">
            <label for="new-address-pincode">Pincode:</label>
            <input type="text" class="form-control" id="new-address-pincode" name="pincode" value="<%= address.pincode %>">
        </div>
      
        <!-- Hidden input field to store the address ID -->
        <input type="hidden" id="edit-address-id" name="id">

        <div class="col-auto text-center ">
            <a href="/address" class="btn btn-secondary cancel-btn">Cancel</a>
            <button type="submit" class="btn btn-primary save-changes-btn">Save Changes</button>
        </div>

    </form>
</div>

<%- include('footer') %>


<script>
document.addEventListener("DOMContentLoaded", () => {
    const editAddressForm = document.getElementById('edit-address-form');

    const fields = {
        contactName: document.getElementsByName('contactName')[0],
        doorNo: document.getElementsByName('doorNo')[0],
        homeAddress: document.getElementsByName('homeAddress')[0],
        areaAddress: document.getElementsByName('areaAddress')[0],
        landmark: document.getElementsByName('landmark')[0],
        phone: document.getElementsByName('phone')[0],
        pincode: document.getElementsByName('pincode')[0]
    };

    editAddressForm.addEventListener('submit', (e) => {
        e.preventDefault();

        const contactNameValue = fields.contactName.value.trim();
        const doorNoValue = fields.doorNo.value.trim();
        const homeAddressValue = fields.homeAddress.value.trim();
        const areaAddressValue = fields.areaAddress.value.trim();
        const landmarkValue = fields.landmark.value.trim();
        const phoneValue = fields.phone.value.trim();
        const pincodeValue = fields.pincode.value.trim();

        let message = "";

        if (!contactNameValue) {
            message = "Contact name cannot be empty";
        } else if (!/^[a-zA-Z\s]+$/.test(contactNameValue)) {
            message = "Enter a valid contact name (letters only)";
        } else if (!doorNoValue) {
            message = "Door number cannot be empty";
        } else if (homeAddressValue.length < 10 || homeAddressValue.length > 100) {
            message = "Home address must be between 10 and 100 characters";
        } else if (areaAddressValue.length < 3 || areaAddressValue.length > 100) {
            message = "Area address must be between 3 and 100 characters";
        } else if (landmarkValue.length > 50) {
            message = "Landmark cannot exceed 50 characters";
        } else if (!/^\d{10}$/.test(phoneValue)) {
            message = "Phone number must be exactly 10 digits";
        } else if (!/^\d{6}$/.test(pincodeValue)) {
            message = "Pincode must be exactly 6 digits";
        }

        if (message) {
            Swal.fire({
                icon: "error",
                title: "Validation Error",
                text: message
            });
        } else {
            editAddressForm.submit();
        }
    });
});

</script>